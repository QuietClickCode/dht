<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>秒杀商品</title>
    <script src="/js/Adaptive.js"></script>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body class="bge6">
    <div class="specialty-title2 borderB">
        <a href="" class="icon-return"></a>
        <span>商品详情</span>
    </div>

    <div id="banner" class="focus">
        <div class="hd bargain">
            <ul></ul>
        </div>
        <div class="bd">
            <ul id="goodsImagesul">
                <li>
                    <img _src="/img/banner1.jpg" src="/img/bangain5.png" />
                </li>
                <li>
                    <img _src="/img/banner1.jpg" src="/img/bangain5.png" />
                </li>
            </ul>
            <!-- 倒计时 -->
            <div class="product-countDown2">
                <span id="minprice" class="price">￥650</span>
                <span class="special-text">秒杀价</span>
                <s id="gprice">￥980</s>
                <div class="time-box">
                    <p class="text">距结束仅剩</p>
                    <div class="time-span">
                        <span id="shi1" class="time">0</span>
                        <span id="shi2" class="time">0</span>
                        <span class="colon">:</span>
                        <span id="fen1" class="time">0</span>
                        <span id="fen2" class="time">0</span>
                        <span class="colon">:</span>
                        <span id="miao1" class="time">0</span>
                        <span id="miao2" class="time">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="bargain-text box2">
        <div class="title" id="goodsNameDiv">2017墨镜男士方形偏光眼镜大框太阳镜女潮人近视墨镜圆脸</div>
        <div class="seckill-address" id="personaddressdiv">
            <div class="text" >
                <span class="seckill-address-title">产自</span>
                <div class="name" id="gproductioninperson">高达山</div>
                <span class="address-text">
                    <i></i>
                    <span id="gproductioninaddress">石柱县高家庄</span>
                </span>
            </div>
            <div class="text" >
                <span class="seckill-address-title">采供</span>
                <div class="name2" id="gpickperson">高达山</div>
                <span class="address-text">
                    <i></i>
                    <span id="gpickaddress">石柱县高家庄</span>
                </span>
            </div>
        </div>
        <div class="norms" id="open_car">
            <span class="name">已选</span>
            <span class="text overflow"> 一斤装（玻璃瓶），数量×1</span>
            <span class="checkbox"></span>
        </div>
        <div class="norms showaddressfreigh">
            <span class="name">送至</span>
            <span class="text overflow" id="open_address"> 重庆市九龙坡区狮山大道巴南小区刚光华苑1栋...</span>
            <span class="checkbox"></span>
        </div>
        <div class="norms" id="open_time">
            <span class="name">配送</span>
            <span class="text overflow"> 选择配送时间</span>
            <span class="checkbox"></span>
        </div>
        <div class="norms showaddressfreigh">
            <span class="name">运费</span>
            <span class="text overflow" id="gfreigh"> 12.0元</span>
        </div>
        <div class="ensure" style="display: none;">
            <span>
                <i class="icon-yes"></i>
                农家自产
            </span>
            <span>
                <i class="icon-yes2"></i>
                农家自产
            </span>
            <span>
                <i class="icon-yes"></i>
                农家自产
            </span>
            <span>
                <i class="icon-yes"></i>
                农家自产
            </span>
        </div>

        <div class="loading-more">
            <i></i>
            上拉查看图文详情
        </div>
    </div>

    <div class="bargain-details box2">
        <div class="bargain-tab" id="J_bargainTab">
            <a href="#details" class="active">商品介绍</a>
            <a href="#evaluate">用户评价</a>
        </div>

        <div class="box2">

            <div class="product-details" id="details">
                <!-- 商品信息 -->
                <div class="like">
                    <div class="cont">
                        <span class="bargain-like">商品信息</span>
                    </div>
                </div>

                <div id="gdescription">
                    <img src="/img/bangain5.png" class="dispalyB" width="100%" alt="">
                </div>
            </div>

            <div class="product-evaluate box2 displayN" id="evaluate">
                <div class="title">
                    <span id="sumgclsspan">全部评价(1990) </span>
                    <div class="stars1" id="avgleveldiv">
                        <i></i>
                        <i></i>
                        <i></i>
                        <i></i>
                        <i></i>
                    </div>
                </div>
                <div class="label box2" id="singlegcldiv">
                    <span>新鲜(1800)</span>
                    <span>新鲜(1800)</span>
                    <span>新鲜(1800)</span>
                    <span>新鲜(1800)</span>
                    <span>新鲜(1800)</span>
                </div>

                <!-- 用户评价 -->
                <div id="usercommentdiv">

                    <div class="user-evaluate">
                        <div class="box2">
                            <img src="/img/class1.png" class="img" alt="">
                            <div class="text">hz2375</div>
                            <div class="stars2">
                                <i></i>
                                <i></i>
                                <i></i>
                                <i></i>
                                <i></i>
                            </div>
                        </div>
                        <div class="label2 box2">
                            <span>新鲜</span>
                            <span>新鲜</span>
                            <span>新鲜</span>
                            <span>新鲜</span>
                        </div>
                    </div>
                    <div class="user-evaluate">
                        <div class="box2">
                            <img src="/img/class1.png" class="img" alt="">
                            <div class="text">hz2375</div>
                            <div class="stars2">
                                <i></i>
                                <i></i>
                                <i></i>
                                <i></i>
                                <i></i>
                            </div>
                        </div>
                        <div class="label2 box2">
                            <span>新鲜</span>
                            <span>新鲜</span>
                            <span>新鲜</span>
                            <span>新鲜</span>
                        </div>
                    </div>
                </div>


                <div class="more" id="nogoodscldiv">

                </div>

            </div>

        </div>
    </div>

    <div class="placeholder-footer2"></div>
    <div class="bargain-footer">
        <div class="special">
            <div class="share">
                <a href="">
                    <i></i>
                    <p>分享好友</p>
                </a>
            </div>
            <!-- <div class="care">
                <a href="">
                    <i>
                        <span class="number">4</span>
                    </i>
                    <p>分享好友</p>
                </a>
            </div> -->
        </div>
        <a href="" class="bargain-btn2">立即购买</a>
    </div>
    <!--选择规格弹框-->
    <div class="mark" id="J_mark2" style="display:none;">
        <div class="care-norms-checkbox J_careNormsCheckbox" style="display:block;">
            <i class="care-norms-close J_careNormsClose2"></i>
            <div class="product">
                <img src="/img/list2.jpg" alt="">
                <div class="text">
                    <span class="mr_4" style="color: #ec3c3c;">￥</span>168.00/桌
                    <br />
                    <span>库存60件</span>
                </div>
            </div>
            <div class="care-checkbox J_careCheckbox">
                <span class="name">规格1</span>
                <span class="checkbox_service" onclick="clickactive(this)">人工费(不包含食材、设备费用)</span>
                <span class="checkbox_service" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
                <span class="checkbox_service" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
            </div>
            <div class="care-checkbox J_careCheckbox">
                <span class="name">规格2</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(不包含食材、设备费用)</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
            </div>
            <div class="care-checkbox J_careCheckbox">
                <span class="name">规格2</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(不包含食材、设备费用)</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
                <span class="checkbox_service2" onclick="clickactive(this)">人工费(包设备用具、不包食材)</span>
            </div>
            <div class="care-checkbox" style="margin-top: .2rem;">
                <span class="name">数量</span>
                <div class="number number-box">
                    <span class="reduce J_careReduce">-</span>
                    <span class="num J_careNum">1</span>
                    <span class="add J_careAdd">+</span>
                </div>
            </div>

            <div class="car_footer_box">
                <a href="" class="add_car_btn">加入购物车</a>
                <a href="" class="add_car_btn2">立即购买</a>
            </div>
        </div>
    </div>

    <div class="mark" id="J_mark3" style="display:none;">
        <div class="care-norms-checkbox J_careNormsCheckbox" style="display:block;">
            <i class="care-norms-close J_careNormsClose3"></i>
            <p class="J_mark_title">选择配送时间</p>
            <div class="care-checkbox J_careCheckbox">
                <span class="checkbox active J_checkbox">橙黄色</span>
                <select name="" class="select_input">
                    <option value="0">选择时间</option>
                    <option value="0">周一至周五</option>
                    <option value="0">周末</option>
                </select>
            </div>
            <a href="" class="care-norms-checkbox-btn">确定</a>
        </div>
    </div>

    <div class="mark" id="J_mark" style="display:none;">
        <div class="care-norms-checkbox J_careNormsCheckbox" style="display:block;">
            <i class="care-norms-close J_careNormsClose" id="closeaddress"></i>
            <p class="J_mark_title">送至</p>
            <ul class="address_list_box" id="addressul">
                <li class="active">
                    <span class="address_img"></span>
                    <div class="address_text">重庆市九龙坡区狮山大道巴南小区刚光华苑1栋</div>
                    <span  class="icon_choice"></span>
                </li>
                <li>
                    <span class="address_img"></span>
                    <div class="address_text">上海市九龙坡区狮山大道巴南小区刚光华苑1栋</div>
                    <span  class="icon_choice"></span>
                </li>
            </ul>
            <a onclick="setaddress(this)" class="care-norms-checkbox-btn">确定</a>
        </div>
    </div>

    <script src="/js/jquery-1.9.1.min.js"></script>
    <script src="/js/public.js"></script>
    <script src="/js/TouchSlide.1.1.js"></script>
    <script src="/js/tabs.js"></script>
    <script src="/js/jquery.lazyload.js?v=1.9.1"></script>

    <!--时间减少-->
    <script>
        var timestape = 0;
        function timegoing() {
            var interval = setInterval(function () {
                var date = new Date(timestape);
                var shi1 = Math.floor((date.getHours()-8)/10);
                var shi2 = Math.floor((date.getHours()-8)%10);
                var fen1 = Math.floor(date.getMinutes()/10);
                var fen2 = Math.floor(date.getMinutes()%10);
                var miao1 = Math.floor(date.getSeconds()/10);
                var miao2 = Math.floor(date.getSeconds()%10);

                $('#shi1').html(shi1);
                $('#shi2').html(shi2);
                $('#fen1').html(fen1);
                $('#fen2').html(fen2);
                $('#miao1').html(miao1);
                $('#miao2').html(miao2);

                timestape -= 1000;
                if(timestape<0){
                    clearInterval(interval);
//                $('#shi1').parent().parent().next().remove();
//                $('#shi1').parent().parent().remove();
                }
            },1000);
        }

    </script>
    <!--定义使用函数-->
    <script>
        var path = window.location.pathname;
        var gid = parseInt(path.substring(10,path.indexOf('.html')));
        var isServiceGoods;
        <!--用户评论分页查询-->
        var pageNo=1;
        var pageSize=10;

        <!--初始化banner-->
        function initbanner() {
            TouchSlide({
                slideCell: "#banner",
                titCell: ".hd ul", //开启自动分页 autoPage:true ，此时设置 titCell 为导航元素包裹层
                mainCell: ".bd ul",
                effect: "left",
                autoPlay: true, //自动播放
                autoPage: true, //自动分页
                switchLoad: "_src" //切换加载，真实图片路径为"_src"
            });
        }

        <!--加载商品图片-->
        function loadgoodsimage() {
            $.ajax({
                type:"post",
                url:'/goodsImage/queryGoodsImages',
                dataType: "json",
                data:{gid:gid,pageNo:1,pageSize:100},
                success:function(data){
                    var goodsImages = data.goodsImages;
                    if(goodsImages!=null&&goodsImages.length>0){
                        var html = '';
                        $('#goodsImagesul').html(html);
                        for(var i=0;i<goodsImages.length;i++){
                            html = '<li>'+
                                '<img _src="'+goodsImages[i].imgUrl+'" src="'+goodsImages[i].imgUrl+'" data-original="'+goodsImages[i].imgUrl+'" style="height: 200px" />'+
                                '</li>';
                            $('#goodsImagesul').append(html);
                        }
                    }
                    initbanner();
                    $("img").lazyload({effect: "fadeIn"});
                }
            });
        }
        <!--加载剩余时间-->
        function loadtimestape() {
            $.ajax({
                type:"post",
                url:'/openSalePromotion/querySalePromotionLists',
                dataType: "json",
                data:{now:new Date().pattern('yyyy-MM-dd hh:mm:ss'),spType:1,gid:gid},
                success:function(data){
                    if(data.rows!=null){
                        timestape = data.rows[0].timestap*1000;
                        $('#gprice').html('￥'+data.rows[0].gprice);
                        $('#goodsNameDiv').html(data.rows[0].goodsName);
                        $('#minprice').html('￥'+data.rows[0].minprice);
                        timegoing();
                    }else{
                        nogoods();
                    }

                }
            });
        }

        <!--加载采摘人和地址-->
        function loadpersonaddress() {
            $.ajax({
                type:"post",
                url:'/goods/queryGoodsById',
                dataType: "json",
                data:{gid:gid,isShow:1,isChecked:1},
                success:function(data){
                    var row = data.row;
                    if(row!=null){
                        var gproductioninperson = row.gproductioninperson;
                        var gproductioninaddress = row.gproductioninaddress;
                        var gpickperson = row.gpickperson;
                        var gpickaddress = row.gpickaddress;
                        if(gproductioninperson==''||gproductioninaddress==''||gpickperson==''||gpickaddress==''){
                            $('#personaddressdiv').hide();
                        }else{
                            $('#gproductioninperson').html(gproductioninperson);
                            $('#gproductioninaddress').html(gproductioninaddress);
                            $('#gpickperson').html(gpickperson);
                            $('#gpickaddress').html(gpickaddress);
                        }
                        $('#gdescription').html(row.gdescription);
                    }else{
                        nogoods();
                    }
                }
            });
        }

        <!--加载商品配置-->
        function loadgoodsconfig() {
            $.ajax({
                type:"post",
                url:'/goodsConfig/queryGoodsConfigBygid',
                dataType: "json",
                data:{gid:gid,pageNo:1,pageSize:2},
                success:function(data){
                    var goodsConfig = data.goodsConfig;
                    if(goodsConfig!=null){
                        isServiceGoods = goodsConfig.isServicegoods;
                        var isAllowsetdeliverytime = goodsConfig.isAllowsetdeliverytime;
                        if(isServiceGoods==1){
                            $('.showaddressfreigh').hide();
                        }else{
                            $('.showaddressfreigh').show();
                        }
                        if(isAllowsetdeliverytime==1){
                            $('#open_time').show();
                        }else{
                            $('#open_time').hide();
                        }
                    }else{
                        nogoods();
                    }
                }
            });
        }

        <!--设置地址和运费-->
        function setaddress(obj) {
            var address = $(obj).prev().find('li[class=active]').find('div').html();
            $('#open_address').html(address);
            $.ajax({
                type:"post",
                url:'/city/queryCityListsByCityName',
                dataType: "json",
                data:{cityname:address.substr(0,2),pageNo:1,pageSize:2},
                success:function(data){
                    var row = data.row;
                    if(row!=null){
                        var gfreigh = row.gfreigh;
                        $('#gfreigh').html(gfreigh+'元');
                    }
                }
            });

            document.getElementById('closeaddress').click();
        }

        <!--商品不存在 跳转页面-->
        function nogoods() {
            //window.location.href='';
        }

        <!--滚动加载商品评论-->
        function scrollgoodsclm() {
            $(document).ready(function(){
                $('#usercommentdiv').html('');
                var range = 50;             //距下边界长度/单位px
                var totalheight = 0;
                var main = $("#usercommentdiv");                     //主体元素
                $(window).scroll(function(){
                    var srollPos = $(window).scrollTop();    //滚动条距顶部距离(页面超出窗口的高度)

                    totalheight = parseFloat($(window).height()) + parseFloat(srollPos);
                    if(($(document).height()-range) <= totalheight ) {
                        $.ajax({
                            type:"post",
                            url:'/goodsUggclrel/queryGoodsUggclrel',
                            dataType: "json",
                            async :false,
                            data:{gid:gid,pageNo:pageNo,pageSize:pageSize},
                            success:function(data){
                                var html = '';
                                var rows = data.rows;
                                if(rows!=null&&rows.length>0){
                                    for(var i=0;i<rows.length;i++){
                                        var gcllevel = parseInt(rows[i].gcllevel);
                                        var gclnames = rows[i].gclname.split(' ');
                                        html = '<div class="user-evaluate ">'+
                                            '<div class="box2">'+
                                            '<img src="'+rows[i].imgurl+'" class="img" alt="">'+
                                            '<div class="text">'+rows[i].uname+'</div>'+
                                            '<div class="stars2">';

                                        for(var j=0;j<gcllevel;j++){
                                            html += '<i></i>';
                                        }

                                        html += '</div>'+
                                            '</div>'+
                                            '<div class="label2 box2">';

                                        for(var j=0;j<gclnames.length;j++){
                                            html += '<span>'+gclnames[j]+'</span>';
                                        }
                                        html += '</div>'+
                                            '</div>';
                                        main.append(html);
                                    }
                                    pageNo++;
                                }else{
                                    html = '<a >已全部加载</a>';
                                    $('#nogoodscldiv').html(html);
                                }
                            }
                        });

                    }
                });
            });
        }

        <!--全部评论数量及平均分数-->
        function sumgclandavglevel() {
            $.ajax({
                type:"post",
                url:'/goodsUggclrel/queryGoodsclsumandavg',
                dataType: "json",
                async :false,
                data:{gid:gid},
                success:function(data){
                    var row = data.row;
                    if(row!=null){
                        $('#sumgclsspan').html('全部评论（'+row.sumgcl+'）');
                        var avglevel = Math.round(row.avglevel);
                        $('#avgleveldiv').html('');
                        for(var i=0;i<avglevel;i++){
                            var html = '<i></i>';
                            $('#avgleveldiv').append(html);
                        }
                    }
                }
            });
        }

        <!--加载已有评论-->
        function loadhasgcl() {
            $.ajax({
                type:"post",
                url:'/goodsUggclrel/queryHasGoodscls',
                dataType: "json",
                async :false,
                data:{gid:gid},
                success:function(data){
                    var rows = data.rows;
                    if(rows!=null&&rows.length>0){
                        var html = '';
                        $('#singlegcldiv').html(html);
                        for(var i=0;i<rows.length;i++){
                            html = '<span>'+rows[i].gclname+'('+rows[i].siglegclsum+')</span>';
                            $('#singlegcldiv').append(html);
                        }
                    }

                }
            });
        }

        <!--点击规格加载信息-->
        function clickactive(obj) {
            $(obj).siblings().removeClass('active');
            $(obj).addClass('active');
        }

        <!--日期格式化-->
        Date.prototype.pattern=function(fmt) {
            var o = {
                "M+" : this.getMonth()+1, //月份
                "d+" : this.getDate(), //日
                "h+" : this.getHours()%12 == 0 ? 12 : this.getHours()%12, //小时
                "H+" : this.getHours(), //小时
                "m+" : this.getMinutes(), //分
                "s+" : this.getSeconds(), //秒
                "q+" : Math.floor((this.getMonth()+3)/3), //季度
                "S" : this.getMilliseconds() //毫秒
            };
            var week = {
                "0" : "/u65e5",
                "1" : "/u4e00",
                "2" : "/u4e8c",
                "3" : "/u4e09",
                "4" : "/u56db",
                "5" : "/u4e94",
                "6" : "/u516d"
            };
            if(/(y+)/.test(fmt)){
                fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
            }
            if(/(E+)/.test(fmt)){
                fmt=fmt.replace(RegExp.$1, ((RegExp.$1.length>1) ? (RegExp.$1.length>2 ? "/u661f/u671f" : "/u5468") : "")+week[this.getDay()+""]);
            }
            for(var k in o){
                if(new RegExp("("+ k +")").test(fmt)){
                    fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
                }
            }
            return fmt;
        }

        $(function(){
        	$("#open_car").click(function(){
        		$("#J_mark2").show()
        	});
        	$(".J_careNormsClose2").click(function(){
        		$("#J_mark2").hide()
        	});
            $(".address_list_box>li").click(function(){
                $(".address_list_box>li").removeClass("active")
                $(this).addClass("active")
            })
            $(".checkbox_service").click(function(){
                $('.checkbox_service').removeClass("active")
                $(this).addClass('active')
            })
        })
    </script>

    <!--初始化页面调用函数-->
    <script>
        <!--加载图片-->
        loadgoodsimage();

        <!--初始化时间-->
        loadtimestape();

        <!--加载生产人采摘人信息-->
        loadpersonaddress();

        <!--加载配置信息-->
        loadgoodsconfig();

        <!--滚动加载商品评论-->
        scrollgoodsclm();

        <!--全部评论数量及平均分数-->
        sumgclandavglevel();

        <!--加载已有评论-->
        loadhasgcl();
    </script>

    <script>
        $(function () {
            <!--图片懒加载-->
            $("img").lazyload({effect: "fadeIn"});
        });
    </script>

    <script>
        $(function(){
            $("#open_address").click(function(){
                $("#J_mark").show()
            })
            $("#open_car").click(function(){
                $("#J_mark2").show()
            })
            $("#open_time").click(function(){
                $("#J_mark3").show()
            })
            $(".J_careNormsClose").click(function(){
                $("#J_mark").hide()
            })
            $(".J_careNormsClose2").click(function(){
                $("#J_mark2").hide()
            })

            $(".J_careNormsClose3").click(function(){
                $("#J_mark3").hide()
            })
            $("#open_dis").click(function(){
                $("#J_mark4").show()
            })
            $(".J_careNormsClose4").click(function(){
                $("#J_mark4").hide()
            })

            $(".address_list_box>li").click(function(){
                $(".address_list_box>li").removeClass("active")
                $(this).addClass("active")
            })
            $(".checkbox_service").click(function(){
                $('.checkbox_service').removeClass("active")
                $(this).addClass('active')
            })
        });

    </script>
</body>

</html>